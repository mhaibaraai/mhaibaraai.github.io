import{_ as i,c as a,ah as t,o as e}from"./chunks/framework.Wall-LJo.js";const h="/vscode/git-vscode-gpg.png",r=JSON.parse('{"title":"Git","description":"","frontmatter":{},"headers":[],"relativePath":"zh/note/environment/git.md","filePath":"zh/note/environment/git.md","lastUpdated":1729672101000}'),l={name:"zh/note/environment/git.md"};function n(p,s,k,d,g,o){return e(),a("div",null,s[0]||(s[0]=[t(`<h1 id="Git" tabindex="-1">Git <a class="header-anchor" href="#Git" aria-label="Permalink to &quot;Git {#Git}&quot;">​</a></h1><blockquote><p>版本控制策略、常用命令和技巧</p></blockquote><h2 id="install" tabindex="-1">安装配置 <a class="header-anchor" href="#install" aria-label="Permalink to &quot;安装配置 {#install}&quot;">​</a></h2><h3 id="mac" tabindex="-1">Mac <a class="header-anchor" href="#mac" aria-label="Permalink to &quot;Mac&quot;">​</a></h3><p>通常自带 Git，但如果没有安装，或者你想更新到最新版本，可以通过以下几种方式安装：</p><ul><li><p>通过 Homebrew 安装</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">brew</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> git</span></span></code></pre></div></li><li><p>通过 Xcode 安装</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">xcode-select</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --install</span></span></code></pre></div></li></ul><h3 id="windows" tabindex="-1">Windows <a class="header-anchor" href="#windows" aria-label="Permalink to &quot;Windows&quot;">​</a></h3><p>通过 Git 官网下载安装包：<a href="https://git-scm.com/download/win" target="_blank" rel="noreferrer">https://git-scm.com/download/win</a></p><p>验证是否安装成功：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --version</span></span></code></pre></div><h2 id="config" tabindex="-1">配置 Git 用户信息 <a class="header-anchor" href="#config" aria-label="Permalink to &quot;配置 Git 用户信息 {#config}&quot;">​</a></h2><p>Git 需要知道提交者的身份信息。通过以下命令设置全局用户信息：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 设置用户名</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> config</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --global</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> user.name</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Your Name</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 设置邮箱</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> config</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --global</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> user.email</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Your Email</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre></div><h2 id="config-editor" tabindex="-1">设置默认编辑器（可选） <a class="header-anchor" href="#config-editor" aria-label="Permalink to &quot;设置默认编辑器（可选） {#config-editor}&quot;">​</a></h2><ul><li><p>设置默认编辑器为 Vim</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> config</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --global</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> core.editor</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> vim</span></span></code></pre></div></li><li><p>设置默认编辑器为 VSCode</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> config</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --global</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> core.editor</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">code --wait</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre></div></li></ul><h2 id="ssh" tabindex="-1">配置 SSH 密钥（用于 GitHub、GitLab 等远程仓库） <a class="header-anchor" href="#ssh" aria-label="Permalink to &quot;配置 SSH 密钥（用于 GitHub、GitLab 等远程仓库）{#ssh}&quot;">​</a></h2><ol><li><p>生成 SSH 密钥</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ssh-keygen</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -t</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rsa</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -b</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 4096</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -C</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">你的邮箱地址</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre></div><p>解释：</p><ul><li><code>-t rsa</code>：指定密钥类型为 RSA</li><li><code>-b 4096</code>：指定密钥长度为 4096 位</li><li><code>-C &quot;你的邮箱地址&quot;</code>：指定注释信息为你的邮箱地址</li></ul><p>执行命令后，会提示你输入保存密钥的文件路径，按回车键默认保存在 <code>~/.ssh/id_rsa</code>。</p></li><li><p>设置密码（可选）</p><p>系统会提示你设置一个密码，这个密码用来加密你的私钥文件。如果你不想设置密码，直接按回车键即可。</p></li><li><p>添加 SSH 密钥到 ssh-agent</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">eval</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ssh-agent</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -s</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ssh-add</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/.ssh/id_rsa</span></span></code></pre></div><p>注意：<code>~/.ssh/id_rsa</code> 是你生成的 SSH 密钥的路径。</p></li><li><p>复制 SSH 公钥到剪贴板</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pbcopy</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/.ssh/id_rsa.pub</span></span></code></pre></div><p>或者对于 Linux 系统：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">cat</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/.ssh/id_rsa.pub</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> xclip</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -selection</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> clipboard</span></span></code></pre></div></li><li><p>在 GitHub、GitLab 等远程仓库添加 SSH 公钥。</p></li><li><p>测试 SSH 连接</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ssh</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -T</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> git@github.com</span></span></code></pre></div></li></ol><h2 id="gpg" tabindex="-1">配置 GPG 密钥 <a class="header-anchor" href="#gpg" aria-label="Permalink to &quot;配置 GPG 密钥 {#gpg}&quot;">​</a></h2><ol><li><p>安装 GPG</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">brew</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> gnupg</span></span></code></pre></div></li><li><p>生成 GPG 密钥</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">gpg</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --full-generate-key</span></span></code></pre></div><ul><li><p><strong>选择密钥类型</strong>：默认情况下，现在的 GPG 会选择 <code>ECC and ECC</code> 。您可以直接按 <code>Enter</code> 选择默认选项，生成 <code>ECC</code> 密钥。</p><div class="warning custom-block"><p class="custom-block-title">注意</p><p><code>ECC</code> 密钥（如 <code>Ed25519</code> ）提供了更高的安全性和更小的密钥尺寸。但在某些旧系统或软件中，可能存在兼容性问题。如果需要最大兼容性，可以选择 <code>RSA and RSA</code> ，然后将密钥长度设置为 <code>4096</code> 位。</p></div></li><li><p><strong>选择曲线类型</strong>： 如果选择了 <code>ECC</code>，系统会提示您选择曲线。默认的 <code>Curve 25519（Ed25519）</code>是推荐的选项，直接按 <code>Enter</code> 即可。</p></li><li><p><strong>设置密钥的有效期</strong>： 输入 <code>0</code> 表示密钥永不过期，或者根据需要设置。</p></li><li><p><strong>用户信息</strong>： 输入您的姓名、邮箱地址（必须与 GitHub 上的邮箱一致）和可选的注释。</p></li><li><p><strong>确认信息</strong>： 检查所有信息是否正确，输入 <code>O</code> 确认。</p></li><li><p><strong>设置密码短语</strong>： 为您的密钥设置一个安全的密码短语。</p></li></ul></li><li><p>查看 GPG 密钥</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">gpg</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --list-secret-keys</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --keyid-format</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> LONG</span></span></code></pre></div><p>会看到类似以下的输出：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">keyboxd</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">----------------</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sec</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   ed25519/密钥ID</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  日期</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [SC]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      密钥指纹</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">uid</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">           [ultimate] 姓名 </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">邮箱</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ssb</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   cv25519/子密钥ID</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  日期</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> [E]</span></span></code></pre></div><p>记录下 <strong>ed25519/</strong> 后面的长密钥 ID。例如，<code>ABCD1234EFGH5678</code>。</p></li><li><p>导出并复制公钥</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">gpg</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --armor</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --export</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 密钥ID</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> pbcopy</span></span></code></pre></div><p>复制的内容类似于：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-----BEGIN</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> PGP</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> PUBLIC</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> KEY</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> BLOCK-----</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mDMEY...</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">...</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-----END</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> PGP</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> PUBLIC</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> KEY</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> BLOCK-----</span></span></code></pre></div></li><li><p>将 GPG 密钥添加到 GitHub</p></li><li><p>配置 Git 使用 GPG 签名</p><ul><li>设置默认签名密钥</li><li>启用自动签名提交</li><li>指定 GPG 程序的路径</li><li>使用默认 <code>openpgp</code> 格式</li></ul><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> config</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --global</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> user.signingkey</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 密钥ID</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> config</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --global</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> commit.gpgsign</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> config</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --global</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> gpg.program</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> $(</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">which</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> gpg</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> config</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --global</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --unset</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> gpg.format</span></span></code></pre></div></li><li><p>安装 pinentry-mac</p><p>pinentry 程序用于提示您输入 GPG 密钥的密码。</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">brew</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pinentry-mac</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">echo</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">pinentry-program </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$(</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">which</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pinentry-mac</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;&gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/.gnupg/gpg-agent.conf</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">killall</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> gpg-agent</span></span></code></pre></div><p>为避免每次提交都输入密码，可以配置 GPG 缓存密码：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">code</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/.gnupg/gpg-agent.conf</span></span></code></pre></div><p>添加以下内容，代表把密码缓存 1 小时，最大缓存时间为 2 小时。</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">default-cache-ttl</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3600</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">max-cache-ttl</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 7200</span></span></code></pre></div><p>重启代理：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">killall</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> gpg-agent</span></span></code></pre></div></li><li><p>在 VSCode 打开 <code>&quot;git.enableCommitSigning&quot;: true,</code> 选项。</p><p><img src="`+h+`" alt="VSCode GPG 设置"></p></li><li><p>gpg failed to sign the data fatal: failed to write commit object？</p><ul><li><p>验证 gpg-agent 是否已启动</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pgrep</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> gpg-agent</span></span></code></pre></div><p>如果命令返回一个或多个进程 ID，表示 gpg-agent 已成功启动。</p><p>如果未运行，尝试重新启动 gpg-agent：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> gpgconf</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --kill</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> gpg-agent</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> gpgconf</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --launch</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> gpg-agent</span></span></code></pre></div></li><li><p>设置环境变量</p><p>在您的 Shell 配置文件（如 <code>~/.bashrc</code> 或 <code>~/.zshrc</code>）中添加：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">export</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> GPG_TTY</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=$(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">tty</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre></div><p>然后重新加载配置文件：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">source</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/.zshrc</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # 或者 source ~/.bash_profile</span></span></code></pre></div></li><li><p>确保 <code>commit.gpgsign</code> 设置为 <code>true</code> ，且没有冲突的条目</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> config</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -l</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> grep</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> gpg</span></span></code></pre></div><p>如果发现有类似以下输出：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">commit.gpgsign</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">=</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">true</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">gpg.program</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">=/opt/homebrew/bin/gpg</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">commit.gpgsign</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">=</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">false</span></span></code></pre></div><p>找出哪个配置文件将 <code>commit.gpgsign</code> 设置为 <code>false</code>,它可能是在你的仓库中的本地 <code>.git/config</code> 文件中设置的：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> config</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --show-origin</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --get-all</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> commit.gpgsign</span></span></code></pre></div><p>全局启用 GPG 签名，删除冲突的配置：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> config</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --global</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> commit.gpgsign</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">git</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> config</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --unset</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> commit.gpgsign</span></span></code></pre></div><p>或者，你也可以手动编辑当前仓库的 <code>.git/config</code> 文件，删除或注释掉 <code>commit.gpgsign=false</code> 这一行。</p></li></ul></li></ol><h2 id="commands" tabindex="-1">常用 Git 命令 <a class="header-anchor" href="#commands" aria-label="Permalink to &quot;常用 Git 命令 {#commands}&quot;">​</a></h2><table tabindex="0"><thead><tr><th>命令</th><th>功能说明</th></tr></thead><tbody><tr><td><code>git rebase --abort</code></td><td>取消变基操作</td></tr><tr><td><code>git branch | grep -v &quot;^\\*&quot; | xargs git branch -D</code></td><td>删除除当前分支外的所有分支</td></tr><tr><td><code>git branch | xargs git branch -D</code></td><td>删除所有本地分支，包括当前分支</td></tr><tr><td><code>git fetch --prune</code></td><td>从远程仓库获取最新的代码，并删除已经被删除的分支</td></tr><tr><td><code>git branch -m &lt;old_branch&gt; &lt;new_branch&gt;</code></td><td>重命名本地分支</td></tr><tr><td><code>git push origin --delete &lt;branch_name&gt;</code></td><td>删除远程分支</td></tr></tbody></table><h2 id="question" tabindex="-1">遇到的问题 <a class="header-anchor" href="#question" aria-label="Permalink to &quot;遇到的问题 {#question}&quot;">​</a></h2><h3 id="question-1" tabindex="-1">Connection closed by 198.18.1.24 port 22 <a class="header-anchor" href="#question-1" aria-label="Permalink to &quot;Connection closed by 198.18.1.24 port 22 {#question-1}&quot;">​</a></h3><p>确保你已经正确配置 SSH 密钥，并将公钥添加到 GitHub。</p><ul><li><p>检查是否有 SSH 密钥：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ls</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -al</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/.ssh</span></span></code></pre></div><p>如果你看不到 <code>id_rsa</code> 和 <code>id_rsa.pub</code>，参考 <a href="#ssh">上文的步骤</a> 生成 SSH 密钥。</p></li><li><p>使用 GitHub 的备用端口 443 ：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">code</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/.ssh/config</span></span></code></pre></div><details class="details custom-block"><summary>遇到了 zsh: command not found: code 错误？</summary><p>使用 <code>vim</code> 或其他编辑器打开 <code>~/.ssh/config</code> 文件：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">vim</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/.ssh/config</span></span></code></pre></div><p>或者参考 <a href="./../mac/vscode#install-code">安装 code 命令行工具</a>。</p></details><p>在文件中添加以下内容：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Host</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> github.com</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Hostname</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ssh.github.com</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">User</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> git</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Port</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 443</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">IdentityFile</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/.ssh/id_rsa</span></span></code></pre></div><p>这个示例配置会让 SSH 在连接到 GitHub 时使用端口 <code>443</code>，并且指定使用你的 <code>~/.ssh/id_rsa</code> 私钥文件。</p></li></ul><h3 id="question-2" tabindex="-1">The authenticity of host &#39;[ssh.github.com]:443 ([198.18.4.3]:443)&#39; can&#39;t be established <a class="header-anchor" href="#question-2" aria-label="Permalink to &quot;The authenticity of host &#39;[ssh.github.com]:443 ([198.18.4.3]:443)&#39; can&#39;t be established {#question-2}&quot;">​</a></h3><ol><li><p>这是因为你第一次连接 GitHub，SSH 不认识 GitHub 的主机密钥。输入 <code>yes</code> 继续连接。</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Are</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> you</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> sure</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> you</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> want</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> to</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> continue</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> connecting</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (yes/no/[fingerprint])</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">?</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> yes</span></span></code></pre></div></li><li><p>将主机密钥添加到 <code>known_hosts</code></p><p>在你输入 <code>yes</code> 后，GitHub 的主机密钥会被添加到 <code>~/.ssh/known_hosts</code> 文件中。如果你想手动添加，可以执行以下命令：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ssh-keyscan</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -t</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rsa</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> github.com</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &gt;&gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/.ssh/known_hosts</span></span></code></pre></div></li></ol>`,27)]))}const y=i(l,[["render",n]]);export{r as __pageData,y as default};
